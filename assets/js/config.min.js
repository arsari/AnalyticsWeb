const SERVER_URL=location.host.includes("127.0.0.1")?"http://localhost:3000":"https://secureserver-fq4v.onrender.com";let config=null;function saveConfigToDB(e){const t=indexedDB.open("MyAppDB",1);t.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("configStore")||t.createObjectStore("configStore",{keyPath:"id"})},t.onsuccess=t=>{const o=t.target.result.transaction(["configStore"],"readwrite");o.objectStore("configStore").put({id:1,config:e}),o.oncomplete=()=>{},o.onerror=()=>{}},t.onerror=e=>{}}function loadConfig(){const e=new XMLHttpRequest;try{e.open("GET",`${SERVER_URL}/config`,!1),e.send(null),200===e.status?(config=JSON.parse(e.responseText),saveConfigToDB(config)):showModal(`Error fetching config. Server responded with status: ${e.status}`)}catch(e){showModal("Backend server is down. Please try again later.")}}function showModal(e){function t(){let t=document.getElementById("errorModal");if(t)return t.querySelector(".modal-message").textContent=e,void(t.style.display="flex");t=document.createElement("section"),t.id="errorModal",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100vw",t.style.height="100vh",t.style.backgroundColor="rgba(0, 0, 0, 0.9)",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.zIndex="1000";const o=document.createElement("div");o.style.backgroundColor="#ffffff",o.style.padding="30px",o.style.borderRadius="8px",o.style.boxShadow="0 2px 10px rgba(0,0,0,0.45)",o.style.maxWidth="400px",o.style.width="80%",o.style.textAlign="center";const n=document.createElement("h2");n.className="modal-message",n.style.fontSize="2ren",n.style.color="#333333",n.textContent=e,o.appendChild(n);const s=document.createElement("button");s.textContent="Retry",s.style.marginTop="20px",s.style.padding="10px 20px",s.style.fontSize="16px",s.style.backgroundColor="#007BFF",s.style.color="#ffffff",s.style.border="none",s.style.borderRadius="4px",s.style.cursor="pointer",s.addEventListener("click",(()=>{t.style.display="none",window.location.reload(),loadConfig()})),o.appendChild(s),t.appendChild(o),document.body.appendChild(t)}document.body?t():document.addEventListener("DOMContentLoaded",t)}loadConfig();